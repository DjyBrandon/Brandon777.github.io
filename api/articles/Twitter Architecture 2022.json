{"title":"Twitter Architecture 2022","uid":"d80392e6f2f5a5f73efea40e3f8764be","slug":"Twitter Architecture 2022","date":"2022-11-22T08:00:00.000Z","updated":"2023-01-23T00:02:17.137Z","comments":true,"path":"api/articles/Twitter Architecture 2022.json","keywords":null,"cover":[],"content":"<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/7615/image-20221122160324913.png\" alt=\"image-20221122160324913\"></p>\n<p>Twitter 架构中客户端设备通过前端以及一个 <code>TFE</code>（短消息前段），<code>iPone</code> 及 <code>web</code> 使用 <code>GraphQL</code> 语言（简单场景可能 <code>RESTful API</code>，如 Facebook）操作 <code>Federated</code> 存储引擎编排微服务（<code>HTTP</code> 协议及 <code>android</code> 的 <code>TLS</code> 安全传输接口已被弃用）将短消息 <code>Tweet</code> 和用户的内容请求进行水合（<code>hydration</code>）、可见性及过滤发送至时间轴混合器，同时将接口请求到 <code>Home Mixer</code> 混合器。<code>Timeline Mixer</code> 获取 Twitter 消息的接口聚合服务，并且依赖了很多内部微服务，比如获取 Twitter 消息时需要注入广告，发现关注者，提示公告等通过 <code>Thrift</code> 可伸缩跨语言服务 <code>RPC</code> 框架传送请求。<code>Home Mixer</code> 混合器类似 <code>BFF</code> 聚合接口服务，按主页场景设计接口聚合数据，<code>Gizmoduck</code> 是用户服务，<code>Tweetypie</code> 是短消息对象服务，<code>Social graph</code> 是用户存放在 <code>Memcache</code> 集群中的社交图。<code>Home Ranker</code> 将数据在分布式集群中进行排序、选举并进行语法分析后找出新建索引的一切东西并传入集群，如 <code>Early Bird</code> 机器。核心还是 <code>Timeline Scorer</code> 和 <code>Home Ranker</code>，<code>Fetch</code> 通过数据流（<code>Stream</code> 对象）分块从机器集群中读取数据并进行特征水合及打分，并按推荐算法将对应的消息列表返回至预加载服务。核心数据存取依赖 Twitter 自建的 <code>Manhattan</code> 分布式实时新一代数据库作为消息分布式存储系统，有点类似 <code>TiDB</code>，业务层还依赖了 <code>Memcache</code> 做了一层缓存。相对于2012多了很多推荐候选级，<code>Feature</code> 测试及验证机制。</p>\n<p><code>Manhattan</code> 官网：<a href=\"https://blog.twitter.com/engineering/en_us/a/2014/manhattan-our-real-time-multi-tenant-distributed-database-for-twitter-scale\">https://blog.twitter.com/engineering/en_us/a/2014/manhattan-our-real-time-multi-tenant-distributed-database-for-twitter-scale</a></p>\n<p><code>Federated</code> 存储引擎：<a href=\"https://blog.csdn.net/jiaona_chen123/article/details/106690958\">https://blog.csdn.net/jiaona_chen123/article/details/106690958</a></p>\n<p><code>WebService</code> 与 <code>HTTP</code> 接口的区别：<a href=\"https://zhuanlan.zhihu.com/p/454803167\">https://zhuanlan.zhihu.com/p/454803167</a></p>\n<p><code>RPC</code> 基础：<a href=\"https://zhuanlan.zhihu.com/p/389845152#:~:text=Thrift是一,一种微服务框架。\">https://zhuanlan.zhihu.com/p/389845152#:~:text=Thrift是一,一种微服务框架。</a></p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/7615/image-20221122160408043.png\" alt=\"image-20221122160408043\"></p>\n","feature":true,"text":" Twitter 架构中客户端设备通过前端以及一个 TFE（短消息前段），iPone 及 web 使用 GraphQL 语言（简单场景可能 RESTful API，如 Facebook）操作 Federated 存储引擎编排微服务（HTTP 协议及 android 的 TLS 安...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"Notes","slug":"Notes","count":1,"path":"api/categories/Notes.json"}],"tags":[{"name":"Architecture","slug":"Architecture","count":1,"path":"api/tags/Architecture.json"}],"toc":"","author":{"name":"Brandon","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/60676912?s=460&v=4","link":"/","description":"Never back down","socials":{"github":"https://github.com/DjyBrandon","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Brandon_","juejin":"https://juejin.cn/user/541388827538679","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"Hackenet Walkthrough","uid":"7b17ab8fd94c1b49243bcf846271ed72","slug":"Hacknet Walkthrough","date":"2022-11-13T06:50:48.000Z","updated":"2022-11-29T14:27:42.756Z","comments":true,"path":"api/articles/Hacknet Walkthrough.json","keywords":null,"cover":"https://images.launchbox-app.com/00333c72-dc8e-4462-8415-7e2cee22ced6.png","text":"Tutorial篇 嗨，我的名字是bit 當你讀到這條訊息的時候我已經死了… Stream游戏hacknet，讲的是一个黑客，生命最后的一段故事… 在你连接到任何系统之后，你需要做的第一件事便是扫描它的相关节点。这将会在地图上显示其相关节点，现在扫描这台电脑。 点击扫描网络 是时...","link":"","photos":[],"count_time":{"symbolsCount":"42k","symbolsTime":"38 mins."},"categories":[{"name":"Cyber Security","slug":"Cyber-Security","count":1,"path":"api/categories/Cyber-Security.json"}],"tags":[{"name":"GOG Games","slug":"GOG-Games","count":1,"path":"api/tags/GOG-Games.json"}],"author":{"name":"Brandon","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/60676912?s=460&v=4","link":"/","description":"Never back down","socials":{"github":"https://github.com/DjyBrandon","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Brandon_","juejin":"https://juejin.cn/user/541388827538679","customs":{}}},"feature":true}}
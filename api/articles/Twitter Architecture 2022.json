{"title":"Twitter Architecture 2022","uid":"d80392e6f2f5a5f73efea40e3f8764be","slug":"Twitter Architecture 2022","date":"2022-11-22T08:00:00.000Z","updated":"2023-01-23T00:13:19.097Z","comments":true,"path":"api/articles/Twitter Architecture 2022.json","keywords":null,"cover":"https://pic2.zhimg.com/80/v2-eb3aeb0dfc84db5b64d8ab24fb757891_720w.webp","content":"<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/7615/image-20221122160324913.png\" alt=\"image-20221122160324913\"></p>\n<p>Twitter 架构中客户端设备通过前端以及一个 <code>TFE</code>（短消息前段），<code>iPone</code> 及 <code>web</code> 使用 <code>GraphQL</code> 语言（简单场景可能 <code>RESTful API</code>，如 Facebook）操作 <code>Federated</code> 存储引擎编排微服务（<code>HTTP</code> 协议及 <code>android</code> 的 <code>TLS</code> 安全传输接口已被弃用）将短消息 <code>Tweet</code> 和用户的内容请求进行水合（<code>hydration</code>）、可见性及过滤发送至时间轴混合器，同时将接口请求到 <code>Home Mixer</code> 混合器。<code>Timeline Mixer</code> 获取 Twitter 消息的接口聚合服务，并且依赖了很多内部微服务，比如获取 Twitter 消息时需要注入广告，发现关注者，提示公告等通过 <code>Thrift</code> 可伸缩跨语言服务 <code>RPC</code> 框架传送请求。<code>Home Mixer</code> 混合器类似 <code>BFF</code> 聚合接口服务，按主页场景设计接口聚合数据，<code>Gizmoduck</code> 是用户服务，<code>Tweetypie</code> 是短消息对象服务，<code>Social graph</code> 是用户存放在 <code>Memcache</code> 集群中的社交图。<code>Home Ranker</code> 将数据在分布式集群中进行排序、选举并进行语法分析后找出新建索引的一切东西并传入集群，如 <code>Early Bird</code> 机器。核心还是 <code>Timeline Scorer</code> 和 <code>Home Ranker</code>，<code>Fetch</code> 通过数据流（<code>Stream</code> 对象）分块从机器集群中读取数据并进行特征水合及打分，并按推荐算法将对应的消息列表返回至预加载服务。核心数据存取依赖 Twitter 自建的 <code>Manhattan</code> 分布式实时新一代数据库作为消息分布式存储系统，有点类似 <code>TiDB</code>，业务层还依赖了 <code>Memcache</code> 做了一层缓存。相对于2012多了很多推荐候选级，<code>Feature</code> 测试及验证机制。</p>\n<p><code>Manhattan</code> 官网：<a href=\"https://blog.twitter.com/engineering/en_us/a/2014/manhattan-our-real-time-multi-tenant-distributed-database-for-twitter-scale\">https://blog.twitter.com/engineering/en_us/a/2014/manhattan-our-real-time-multi-tenant-distributed-database-for-twitter-scale</a></p>\n<p><code>Federated</code> 存储引擎：<a href=\"https://blog.csdn.net/jiaona_chen123/article/details/106690958\">https://blog.csdn.net/jiaona_chen123/article/details/106690958</a></p>\n<p><code>WebService</code> 与 <code>HTTP</code> 接口的区别：<a href=\"https://zhuanlan.zhihu.com/p/454803167\">https://zhuanlan.zhihu.com/p/454803167</a></p>\n<p><code>RPC</code> 基础：<a href=\"https://zhuanlan.zhihu.com/p/389845152#:~:text=Thrift是一,一种微服务框架。\">https://zhuanlan.zhihu.com/p/389845152#:~:text=Thrift是一,一种微服务框架。</a></p>\n<p><img src=\"https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/7615/image-20221122160408043.png\" alt=\"image-20221122160408043\"></p>\n","feature":true,"text":" Twitter 架构中客户端设备通过前端以及一个 TFE（短消息前段），iPone 及 web 使用 GraphQL 语言（简单场景可能 RESTful API，如 Facebook）操作 Federated 存储引擎编排微服务（HTTP 协议及 android 的 TLS 安...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"Notes","slug":"Notes","count":1,"path":"api/categories/Notes.json"}],"tags":[{"name":"Architecture","slug":"Architecture","count":1,"path":"api/tags/Architecture.json"}],"toc":"","author":{"name":"Brandon","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/60676912?s=460&v=4","link":"/","description":"Never back down","socials":{"github":"https://github.com/DjyBrandon","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Brandon_","juejin":"https://juejin.cn/user/541388827538679","customs":{}}},"mapped":true,"prev_post":{"title":"Computer Organization Final Exam","uid":"112cac3ec839e9ef0f511687544cce5a","slug":"Computer Organization Final Exam","date":"2022-12-30T06:59:28.000Z","updated":"2023-02-15T03:56:39.543Z","comments":true,"path":"api/articles/Computer Organization Final Exam.json","keywords":null,"cover":"https://www.sigarch.org/wp-content/uploads/2019/09/AdobeStock_251486231.jpeg","text":"题型15道选择30分 70分综合（7-8道大题） 题型课后题 CH 2 补码定点运算 计算题，大题补码运算（补码加减法，定点加减法） 真值：计算机中用 正负号+绝对值 表示的数。 机器数：计算机中把 符号位和数值 数码化以后的数。 原码：在数值前直接加一符号位的表示法。0正1负，...","link":"","photos":[],"count_time":{"symbolsCount":"8.4k","symbolsTime":"8 mins."},"categories":[{"name":"Computer","slug":"Computer","count":4,"path":"api/categories/Computer.json"}],"tags":[{"name":"Computer Organization","slug":"Computer-Organization","count":3,"path":"api/tags/Computer-Organization.json"}],"author":{"name":"Brandon","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/60676912?s=460&v=4","link":"/","description":"Never back down","socials":{"github":"https://github.com/DjyBrandon","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Brandon_","juejin":"https://juejin.cn/user/541388827538679","customs":{}}},"feature":true},"next_post":{"title":"Computer Organization Experiments","uid":"fb88d64fcf798feb77fdf3f6e5e362c2","slug":"Computer Organization Experiment","date":"2022-11-13T06:50:48.000Z","updated":"2022-11-13T13:29:57.188Z","comments":true,"path":"api/articles/Computer Organization Experiment.json","keywords":null,"cover":"https://www.techyv.com/sites/default/users/Images-Folder/About-Computer-Organization-and-Architecture.jpg","text":" 人工进行输入输出 将DSN文件右下角的B7~B0接线端连接至INPUT UNIT的D7~D0接线端 鼠标左键框选B7~B0，右键块复制 ","link":"","photos":[],"count_time":{"symbolsCount":73,"symbolsTime":"1 mins."},"categories":[{"name":"Computer","slug":"Computer","count":4,"path":"api/categories/Computer.json"}],"tags":[{"name":"Computer Organization","slug":"Computer-Organization","count":3,"path":"api/tags/Computer-Organization.json"}],"author":{"name":"Brandon","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/60676912?s=460&v=4","link":"/","description":"Never back down","socials":{"github":"https://github.com/DjyBrandon","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"https://blog.csdn.net/Brandon_","juejin":"https://juejin.cn/user/541388827538679","customs":{}}},"feature":true}}